package ar.com.erisx;

import java.util.LinkedList;
import java.util.List;

public class Test {

    String message = "";


    public static void main(String[] args) {
        //String unMensaje ="8=FIX.4.4|9=k|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=7.127312510858753|40=2|44=3850.332270238822|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=k|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=9.188546839055345|40=2|44=3798.196493605347|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=h|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=9.087630480983979|40=2|44=3877.059900626282|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=d|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=5.277683703187677|40=2|44=3905.92608916701|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=b|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=1.2041121721217032|40=2|44=3840.3748981730146|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=g|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=4.585578580694852|40=2|44=3542.6033905872996|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=z|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=5.2789017213012155|40=2|44=3909.3653856134943|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=r|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=3.1124285685579345|40=2|44=3587.1467351398346|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=p|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=8.277300854219435|40=2|44=3589.223067611813|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=b|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=9.83909267951244|40=2|44=3732.8937813754565|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=v|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=3.308315720424061|40=2|44=3726.853933480244|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=t|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=4.2782688796352915|40=2|44=3527.7423260998407|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=z|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=10.349933118905096|40=2|44=3992.7313684726464|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=r|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=9.019577341097014|40=2|44=3853.144430568396|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=b|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=1.1652347733666204|40=2|44=3798.497777110813|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|8=FIX.4.4|9=c|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=2.1492249310788516|40=2|44=3681.767008872794|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|";
        //String unMensaje ="008872794|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|";
        String unMensaje = "8=FIX.4.4|9=k|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=ERISX|11=123|38=7.127312510858753|40=2|44=3850.332270238822|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|" +
                "8=FIX.4.4|9=k|35=D|34=1|49=TRADER|52=20190101-20:20:41:000|56=";
        //String unMensaje = "008872794|54=1|55=BTCUSD|59=1|60=2020-01-21T14:25:05.154|10=111|";
        new Test(unMensaje);
    }


    List<String> messages = new LinkedList<>();
    StringBuilder stringBuilder = new StringBuilder();
    int cont = 0;

    public Test(String incomingMessage) {

        this.message = this.message +incomingMessage;

        int index = 0;
        do {
            index = message.indexOf("|");
            if (index != -1) {
                stringBuilder.append(message.substring(0, index) + "|"  );
                cont++;
                message = message.substring(index+1, message.length());
            }else {
               stringBuilder.append(message);

            }

            if (cont == 16) {
                messages.add(stringBuilder.toString());
                stringBuilder = new StringBuilder();
                cont = 0;
            }
        } while (index != -1);

        message = stringBuilder.toString();
        messages.forEach(System.out::println);

    }
}
